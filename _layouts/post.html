<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <!-- Favicon for browsers and Google Search -->
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="icon" href="/monogram.png" type="image/png" />
    <link rel="apple-touch-icon" href="/monogram.png" />

    <title>{% if page.title %}{{ page.title }} ‚Äî {% endif %}Nixon Hanna</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Fraunces:opsz,wght@14..144,600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{{ site.baseurl }}/styles.css" />
    <script>
        // Apply theme immediately to prevent flash of unstyled content
        (function () {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>
</head>

<body>
    <aside class="sidebar">
        <img src="{{ site.baseurl }}/headshot.jpg" alt="Headshot" class="sidebar-headshot">
        <a class="brand" href="{{ '/' | relative_url }}">Nixon Hanna</a>
        <p class="tagline">Constantly finding new interests</p>

        <nav class="nav" id="site-nav">
            <a href="{{ '/' | relative_url }}" {% if page.url=='/' %}class="is-active" {% endif %}>Hello</a>
            <a href="{{ '/about.html' | relative_url }}" {% if page.url=='/about.html' %}class="is-active" {% endif
                %}>About</a>
            <a href="{{ '/blog.html' | relative_url }}" {% if page.url=='/blog.html' %}class="is-active" {% endif
                %}>Blog</a>
            <a href="{{ '/contact.html' | relative_url }}" {% if page.url=='/contact.html' %}class="is-active" {% endif
                %}>Contact me</a>
        </nav>

        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark mode">
            <span class="theme-icon">üåô</span>
        </button>

        <div class="sidebar-header-buttons">
            <button class="theme-toggle theme-toggle-mobile" id="theme-toggle-mobile" aria-label="Toggle dark mode"
                title="Toggle dark mode">
                <span class="theme-icon">üåô</span>
            </button>
            <button class="menu-toggle" id="menu-toggle" aria-expanded="false" aria-controls="site-nav">Menu</button>
        </div>
    </aside>

    <main class="content">
        <article class="entry">
            <header class="entry-head">
                <h1 class="h1">{{ page.title }}</h1>
                <div class="entry-meta">
                    <div class="entry-dates">
                        <time datetime="{{ page.date | date: '%Y-%m-%d' }}">{{ page.date | date: '%b %-d, %Y' }}</time>
                        {% assign words = content | strip_html | number_of_words %}
                        {% assign read_time = words | divided_by: 225.0 | ceil %}
                        {% if read_time < 1 %}
                        {% assign read_time = 1 %}
                        {% endif %}
                        <span class="entry-date-separator">¬∑</span>
                        <span class="entry-read-time">{{ read_time }} min read</span>
                        {% if page.updated %}
                        <span class="entry-date-separator">¬∑</span>
                        <span class="entry-updated">Updated <time datetime="{{ page.updated | date: '%Y-%m-%d' }}">{{
                                page.updated | date: '%b %-d, %Y' }}</time></span>
                        {% endif %}
                    </div>
                    {% if page.tags.size > 0 %}
                    <ul class="taglist">
                        {% for tag in page.tags %}
                        <li><a href="{{ '/blog.html' | relative_url }}#tag-{{ tag | downcase }}" class="tag-link"
                                data-tag="{{ tag }}">{{ tag }}</a></li>
                        {% endfor %}
                    </ul>
                    <script>
                        // Normalize tag links to match JavaScript regex: /[^a-z0-9]+/g -> '-'
                        (function () {
                            const tagLinks = document.querySelectorAll('.tag-link[data-tag]');
                            tagLinks.forEach(link => {
                                const tag = link.getAttribute('data-tag');
                                const normalized = tag.toLowerCase().replace(/[^a-z0-9]+/g, '-');
                                const href = link.getAttribute('href').split('#')[0] + '#tag-' + normalized;
                                link.setAttribute('href', href);
                            });
                        })();
                    </script>
                    {% endif %}
                </div>
            </header>

            {% if page.substack %}
            <div class="substack-link">
                <p>This post is also available on <a href="{{ page.substack }}" target="_blank"
                        rel="noopener noreferrer">Substack</a>.</p>
            </div>
            {% endif %}

            {{ content }}

            <hr class="rule">
            <p class="post-nav"><a href="{{ '/blog.html' | relative_url }}">‚Üê Back to Blog</a></p>
        </article>
    </main>

    <script>
        (function () {
            // Theme management
            const themeToggle = document.getElementById('theme-toggle');
            const themeToggleMobile = document.getElementById('theme-toggle-mobile');
            const html = document.documentElement;

            // Get saved theme or default to light
            const savedTheme = localStorage.getItem('theme') || 'light';
            html.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);

            function updateThemeIcon(theme) {
                const icon = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
                const icons = document.querySelectorAll('.theme-icon');
                icons.forEach(el => el.textContent = icon);
            }

            function toggleTheme() {
                const currentTheme = html.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                html.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateThemeIcon(newTheme);
            }

            if (themeToggle) {
                themeToggle.addEventListener('click', toggleTheme);
            }
            if (themeToggleMobile) {
                themeToggleMobile.addEventListener('click', toggleTheme);
            }

            // Menu toggle
            const toggle = document.getElementById('menu-toggle');
            const sidebar = document.querySelector('.sidebar');
            if (!toggle || !sidebar) return;
            toggle.addEventListener('click', function () {
                const open = sidebar.classList.toggle('is-menu-open');
                toggle.setAttribute('aria-expanded', String(open));
                document.body.style.overflow = open ? 'hidden' : '';
            });
        })();
    </script>
</body>

</html>